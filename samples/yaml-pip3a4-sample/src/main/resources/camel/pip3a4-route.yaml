- route:
    id: pip3a4-unmarshal-route
    from:
      uri: file:data/input
      parameters:
        noop: true
        delay: 5000
      steps:
        - log:
            message: "Processing RosettaNet PIP3A4 message: ${header.CamelFileName}"
        - to:
            uri: rosettanet:unmarshal
            parameters:
              pipType: PIP3A4
              version: "02_05"
              messageName: PurchaseOrderRequest
        - log:
            message: "Successfully unmarshalled PIP3A4 message"
        - marshal:
            json: {}
        - to:
            uri: file:data/output
            parameters:
              fileName: "${header.CamelFileName}.json"

- route:
    id: pip3a4-marshal-route
    from:
      uri: timer:marshal
      parameters:
        period: 60000
        repeatCount: 1
      steps:
        - log:
            message: "Creating sample RosettaNet PIP3A4 Purchase Order Request"
        - setBody:
            constant: |
              {
                "orderNumber": "PO-12345",
                "orderDate": "2025-11-01",
                "items": [
                  {
                    "productId": "PROD-001",
                    "quantity": 100,
                    "unitPrice": 25.99
                  }
                ]
              }
        - unmarshal:
            json: {}
        - log:
            message: "Marshalling to RosettaNet PIP3A4 format"
        - to:
            uri: rosettanet:marshal
            parameters:
              pipType: PIP3A4
              version: "02_05"
              messageName: PurchaseOrderRequest
        - to:
            uri: file:data/output
            parameters:
              fileName: "sample-po-request.xml"
